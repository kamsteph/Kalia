import json

def interpret_web(scan_output):
    findings = []

    try:
        data = json.loads(scan_output)

        for vuln in data.get("vulnerabilities", []):
            vtype = vuln.get("type", "").lower()

            if "sql" in vtype:
                findings.append({
                    "type": "sqli",
                    "url": vuln["url"],
                    "param": "id"  # optional guess
                })

            elif "xss" in vtype:
                findings.append({
                    "type": "xss",
                    "url": vuln["url"]
                })

    except Exception as e:
        print(f"[!] Failed to interpret web scan: {e}")

    return findings
