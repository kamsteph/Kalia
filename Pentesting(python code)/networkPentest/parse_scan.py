import xml.etree.ElementTree as ET

def parse_nmap_output(xml_file):
    print("[+] Parsing Nmap XML...")
    results = []
    tree = ET.parse(xml_file)
    root = tree.getroot()
    for host in root.findall('host'):
        ip = host.find('address').attrib['addr']
        for port in host.find('ports').findall('port'):
            port_num = port.attrib['portid']
            service = port.find('service').attrib.get('name', 'unknown')
            results.append((ip, port_num, service))
    return results
